function tarray=PseudoRandom(numtrials, alist, blist, clist)%% creates a pseudoramdom array containing balanced trials for up to three% different conditions%% takes as input:%	the number of trials that you want% 	the number of conditions for parameter 1% 	the number of conditions for parameter 2% 	the number of conditions for parameter 3% returns tarray, describing the the value of parameters 1, 2, and 3 for% each trial.nparams=nargin-1;%number of inputparameter - 1%nparams=2%alist=2; % either control condition or real condition%blist=4; %51:6; %the size of the aperture%numtrials=30;asize=length(1:alist);% alist= control/realconditionif nparams==1    bsize=1;    csize=1;elseif nparams==2    bsize=length(1:blist);%blist= 5 different aperture sizes    csize=1;elseif nparams==3    bsize=length(1:blist);    csize=length(1:clist);elseif nparams>3    disp('WARNING, CAN ONLY WITH THREE CONDITION TYPES');endset=asize*bsize*csize;%all different possibilities of conditions% if set>numtrials% 	disp('WARNING, NOT ALL POSSIBLE CONDITIONS WILL BE PRESENTED!!!');% endnsets=ceil(numtrials/set); % how many sets of trials do we need?alltrials=nsets*set;tarray=zeros(alltrials, nparams); % fill trial array with zerosfor a=1:asize    tarray(((a-1)*(alltrials/asize))+1:(a*(alltrials/asize)), 1)=a;endif nparams>=2    for b=1:bsize*asize        tarray(((b-1)*(alltrials/(bsize*asize)))+1: ...            (b*(alltrials/(bsize*asize))), 2)=mod(b-1, bsize)+1;    endendif nparams==3    for c=1:set        tarray(((c-1)*(alltrials/set))+1:(c*(alltrials/set)), 3)=mod(c-1, csize)+1;    endendif(1)    ind=randperm(size(tarray,1));    tarray(:, 1)=tarray(ind, 1);    if nparams>=2        tarray(:, 2)=tarray(ind, 2);    end    if nparams==3        tarray(:, 3)=tarray(ind, 3);    endendtarray=tarray(1:numtrials, :);